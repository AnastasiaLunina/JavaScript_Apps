import {Outlet} from 'outlet'
import LiveServiceHub from 'live-service-hub'

export class Live extends Outlet {

  constructor() {
    const container = {}
    super(container)
    // For IE10 compatibility to workaround a Babel issue: https://phabricator.babeljs.io/T3041
    Outlet.call(this, container)
    // ---
    const {PluginLoader} = require('./pluginLoader')
    //this.serviceHub = new LiveServiceHub({runOnConsume: true})
    this.serviceHub = new LiveServiceHub()
    this.pluginLoader = new PluginLoader(container, this.serviceHub)
  }

  start() {
    this.serviceHub.run()
    return this.perform('start', async () => {  })
  }

  // Manual plugin registration.
  register(module, file) {
    this.pluginLoader.register(module, file)
  }

}
